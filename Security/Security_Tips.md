# Security 関連の試験 Tips

最終編集日： 2025/10/26

## 「何を」保護し、「いつ」対応するか

Google Cloud のセキュリティシナリオ問題の多くは、「何を」保護し、「いつ」対応するかが問題となっている。
問題文を読んだら、まず以下の2つの軸で要件を分類するのが望ましい。これにより、無関係な選択肢を即座に除外できる。

### 「何を」保護するか？

セキュリティの対象は、大きく「設定（インフラ）」と「データ（中身）」の2つに分けられる。

* A. リソースと設定のセキュリティ (Security Posture)
  * これは、リソース（バケット、VM、ネットワークなど）が **「どのように構成されているか」** という問題です。

  * 主な問い: 
    * インフラの設定は安全か？
    * 推奨されるベストプラクティスに従っているか？
    * 脆弱な構成（例: パブリックアクセス、広すぎるファイアウォール、不十分なロギング）はないか？

  * 主な関連サービス:
    * **Security Command Center (SCC)**: 既知の脆弱性や設定ミスを検出し、セキュリティ体制を評価する
    * **組織のポリシー (Organization Policy)**: 特定の構成（例: 外部IPの付与）を禁止する
    * **VPC ファイアウォール / Cloud Armor**: ネットワークレベルのアクセスを制御・ブロックする

* B. データのセキュリティ (Data Protection)
  * これは、リソースの **「中に何が保存されているか」** という問題です。

  * 主な問い: 
    * どこに機密データ（PII, PCI, 医療情報）があるか？
    * そのデータは適切に分類・暗号化されているか？
    * データがマスキング（匿名化）されているか？

  * 主な関連サービス:
    * **Sensitive Data Protection (SDP / 旧 DLP)**: データの中身をスキャンして機密情報を検出し、分類し、マスキングする
    * **Cloud Key Management Service (KMS)**: データの暗号化に使用する鍵を管理する
    * **VPC Service Controls**: 承認されたネットワーク境界の外へデータが持ち出されるのを防ぐ

> [!TIP]
> 一例として GCS バケットで考えると、それぞれ以下のような機能の棲み分けとなる。
> 
> * SCC は「バケットが公開されていること（設定の問題）」を検出する
> * SDP は「公開バケットに機密データが含まれていること（データの問題）」を検出する

### 「いつ」対応するか？

「違反を防ぎたいのか（予防）」、それとも「違反を見つけたいのか（発見）」を判断する。

* A. 予防的統制 (Preventive Controls)
  * 違反やインシデントが発生するのを未然に防ぐための制御

  * キーワード: 
    * 防ぐ
    * 禁止する
    * 制限する
    * ～できないようにする準拠させる

  * 主な関連サービス:
    * **IAM (Identity and Access Management)**: 「誰が」「何を」できるかを定義し、不正な操作を防ぐ
    * **組織のポリシー (Organization Policy)**: 「リソースを特定リージョンのみに作成する」など、ポリシー違反の構成を禁止する
    * **VPC Service Controls**: サービス間のデータ移動を制限し、データ漏洩を防ぐ
    * **IAP (Identity-Aware Proxy)**: ゼロトラストモデルで、リソースへのアクセスを制御する

* B. 発見的統制 (Detective Controls)
  * 違反やインシデントが発生した（または、している）ことを見つけるための制御

  * キーワード: 
    * 見つける
    * 検出する
    * スキャンする
    * 特定する
    * アラートを上げる
    * 監査する

  * 主な関連サービス:
    * **Sensitive Data Protection (SDP)**: 既に保存されている非準拠の機密データを発見する
    * **Security Command Center (SCC)**: 構成ミスや脆弱性を発見する
    * **Cloud Logging**: 発生したイベント（API呼び出しなど）を記録し、レビューできるようにする
    * **Cloud Monitoring**: ログやメトリクスに基づいてアラートを上げる

* C. 修正的統制 (Corrective Controls)
  * 違反が発見された後に、それを自動的に修正・修復するための制御

  * キーワード:
    * 自動修復する
    * 修正する

  * 主な関連サービス:
    * **Cloud Functions / Cloud Run**: SCC の検出結果やログをトリガーにして、自動的に設定（例: 公開バケットを非公開にする）を修正するスクリプトを実行する

> [!TIP]
> 試験での応用
> 「EU域外のバケットに医療データが含まれているかを検出したい」
> 
> * 「含まれているか」 → データ (Data) の問題
> * 「検出したい」 → 発見 (Detective) の機能
> 
> このマトリクスから、**「データ」×「発見」** の領域が最も適切であり、その中核となるサービスは Sensitive Data Protection であると瞬時に判断できる

#### 【まとめ】
| 統制の機能 | 保護対象: 設定 (Security Posture) | 保護対象: データ (Data Protection) |
| :--- | :--- | :--- |
| **予防的統制**<br>*(Preventive)* | **目的:** 安全でない構成や違反ポリシーの作成を**未然に防ぐ**。<br><br>**キーワード:**「禁止する」「制限する」「防ぐ」「～できないようにする」<br><br>**主なサービス:**<br>• **IAM**: 権限のない操作を禁止<br>• **組織のポリシー**: 特定の構成（例: 外部IP）を禁止<br>• **VPC ファイアウォール**: 不正なネットワークアクセスをブロック<br>• **IAP**: ゼロトラストでリソースへのアクセスを制御 | **目的:** 機密データの不正な移動、漏洩、または不正アクセスを**未然に防ぐ**。<br><br>**キーワード:**「持ち出させない」「暗号化する」「マスキングする」<br><br>**主なサービス:**<br>• **VPC Service Controls**: サービス境界外へのデータ持ち出しを禁止<br>• **Cloud KMS**: データを暗号化して保護<br>• **Sensitive Data Protection**: データを保存 *前* にマスキング（匿名化）する |
| **発見的統制**<br>*(Detective)* | **目的:** 既存の設定ミス、脆弱性、コンプライアンス違反を**見つける**。<br><br>**キーワード:**「検出する」「スキャンする」「特定する」「アラート」<br><br>**主なサービス:**<br>• **Security Command Center (SCC)**: 構成ミスや脆弱性を検出<br>• **Cloud Logging**: 発生したイベント（API操作）を記録・監査<br>• **Cloud Monitoring**: 異常なアクティビティを監視しアラート | **目的:** *既に保存されている* 機密データ（PIIなど）がどこにあるか、または非準拠な状態（例: EU域外）かを**見つける**。<br><br>**キーワード:**「検出する」「分類する」「監査する」<br><br>**主なサービス:**<br>• **Sensitive Data Protection (SDP)**: バケットやDB内の機密データをスキャンして検出・分類<br>• **Cloud Logging**: データアクセス監査ログで「誰がデータにアクセスしたか」を監査 |


## TBD

| 観点 | 解説 |
| :--- | :--- |
| **試験の最重要原則** | 「すべてを暗号化する」という理想的な選択肢ではなく、「**技術的にサポートされている範囲で、要件を最大限に満たす**」現実的な選択肢が正解となる。 |
| **保護対象の分類** | CMEK のサポート可否は、データが「**ユーザーデータ**」か「**サービスメタデータ**」かで判断する。 |
| **ユーザーデータ**<br>(Data Plane) | **CMEKサポート (ほぼ対象)**。<br>ユーザーが直接所有し、サービスに保存・処理させるデータの中身そのもの。<br>• **例:** Cloud Storage オブジェクト、BigQuery テーブルデータ、Persistent Disk のデータブロック、Vertex AI のコード/データ/モデル。 |
| **サービスメタデータ**<br>(Control Plane) | **CMEKサポート対象外 (ほぼ対象外)**。<br>Google Cloud サービスがリソースを運用・管理するために使用する情報。これらは Google のデフォルト暗号化で保護される。<br>• **例:** リソース名、ラベル、VM の状態 (`RUNNING` 等)、Vertex AI ジョブ名、BigQuery のクエリテキスト。 |
| **メタデータ非対応の理由** | サービスが正常に動作するには、Google がその「状態（メタデータ）」を読み取れる必要があるため。顧客がキーを無効化すると、サービス自体が機能不全に陥る。 |
| **試験アプローチ (Step 1)** | **要件のキーワードを特定する。**<br>「顧客管理のキー」「組織によって制御されるキー」などがあれば、CMEK が必須と判断。「Google のデフォルト暗号化」の選択肢は除外する。 |
| **試験アプローチ (Step 2)** | **理想 vs 現実の選択肢を比較する。**<br>「メタデータを含む」理想的な選択肢と、「ユーザーデータのみ」の現実的な選択肢（例: Vertex AI の問題の B と C）を比較する。 |
| **試験アプローチ (Step 3)** | **技術的制約を適用する。**<br>「サービスメタデータは CMEK 対象外」の原則を適用し、「メタデータを含む」選択肢を**技術的に実装不可能**として除外する。 |
| **試験アプローチ (Step 4)** | **最適解を決定する。**<br>「技術的に実装可能」であり、かつ要件（CMEK）を「最大限に満たしている（＝サポート対象の全ユーザーデータをカバー）」選択肢を正解として選ぶ。 |
