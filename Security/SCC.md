# Security Command Center（SCC）

最終編集日： 2025/9/27

## 概要

Google Cloud 上で使用しているサービスの脆弱性や脅威となりうる設定を検知することができるサービス

* 検知された脆弱性や脅威は、Google Cloud のダッシュボードに表示したり Pub/Sub にメッセージをパブリッシュすることができる
* SCC は Google Cloud の組織単位で有効にできるサービスなので、Google Cloud プロジェクトのみを使用しているユーザーは使用できない

## 機能

### Security Health Analytics

* Google Cloud 内の脆弱性を検知する、マネージド脆弱性スキャン機能

* 検知可能な対象
  * 一般的な脆弱性（CIS Benchmarkに基づく）
  * 明らかな構成ミス（Firewallに過剰な穴がある、IAM権限が余剰である、等）

* 対応しているプロダクト
  * Cloud Monitoring/Logging
  * Compute Engine/GKE
  * Cloud Storage
  * Cloud SQL
  * Cloud IAM
  * Cloud KMS
  * Cloud DNS

* スキャンモード

    | 用語 | 説明 |
    | ---- | ---- |
    | バッチスキャン | 	1日に2回以上定期実行する。<br>12時間毎 or 6時間毎に実行を選択する。 |
    | リアルタイムスキャン | リソース構成の変更が発生する度にリアルタイムに実行する。 |
    | 混合モード | 	リアルタイムスキャンでは対応できないリソースの場合、例外的にバッチスキャンを実行する。 |

### Web Security Scanner

* GKE、GAE、GCE 上に展開された WEB アプリの脆弱性スキャン機能
* OWASP Top10 に準じた脆弱性評価を行う
* 検出する脆弱性
    | 用語 | 説明 |
    | ---- | ---- |
    | XSS（クロスサイトスクリプティング） | 悪意のあるスクリプトがウェブサイトに埋め込まれ、ユーザーのブラウザ上で実行されてしまう問題 |
    | SSRF（サーバーサイドリクエストフォージェリ） | 攻撃者がサーバーを騙して、意図しない場所にリクエストを送信させてしまう問題 |
    | SQLi（SQLインジェクション） | データベースへの命令文（SQL）に不正な文字列を紛れ込ませ、データを盗んだり改ざんしたりする攻撃 |
    | パスワードの平文公開 | パスワードが暗号化されずに、そのままのテキスト（平文）で送信・保存されている状態 |
    | リポジトリの公開 | 本来は非公開であるべきプログラムのソースコード管理場所（リポジトリ）が、外部からアクセス可能になっている状態 |

* 重要なベストプラクティス抜粋
  * 本番環境での実行は非推奨、検証環境等の影響がない環境で実施を推奨
  * テスト用のアカウントを作成し利用することを推奨
  * テスト時にクリック等による誤作動や動作をしてほしくないボタンには、CSSクラスの「inq-no-click」を利用すること
  * テスト前に必ずアプリケーションやデータのバックアップを取得したうえで実施すること
  * テストしてほしくないURLがあれば除外指定をすること

### Anomaly Detection

* 異常検知を目的とした機能
* 検知すること
  * サービスアカウントの認証情報が漏洩していたり、不正利用の可能性がないか
  * VMの不正利用の可能性がないか

### Event Threat Detection（Premiumのみ、Standard利用不可）

* 脅威インテリジェンス・機械学習などを使用して、組織ログをモニタリングし、脅威を検出する機能
* Cloud Logging 等のログベースでデータの不正持出しやマルウェアの攻撃といった脅威を検出することができる

### Container Threat Detection（Premiumのみ、Standard利用不可）

* コンテナ ランタイム攻撃の検出する機能
* GKE 上に専用ノードを立ち上げ、ノードの意図せぬ変更やコンテナへの攻撃を検出することができる

### Virtual Machine Threat Detection（Premiumのみ、Standard利用不可）

* VM インスタンス内で実行されている暗号通貨マイニング アプリケーションを検出する機能
* 具体的にはメモリ内を検査し、暗号通貨マイニング アプリケーションが起動していないかを検出する
